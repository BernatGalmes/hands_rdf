<!DOCTYPE html>
<html lang="en">
<head>
  <title>Resultats detecció de mans en imatges de profunditat</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
  <style>

      .nav-side-menu {
    overflow: auto;
    font-family: verdana;
    font-size: 12px;
    font-weight: 200;
    background-color: #2e353d;
    position: fixed;
    top: 0px;
    width: 300px;
    height: 100%;
    color: #e1ffff;
}

.nav-side-menu .brand {
    background-color: #23282e;
    line-height: 50px;
    display: block;
    text-align: center;
    font-size: 14px;
}

.nav-side-menu .toggle-btn {
    display: none;
}

.nav-side-menu ul,
.nav-side-menu li {
    list-style: none;
    padding: 0px;
    margin: 0px;
    line-height: 35px;
    cursor: pointer;
}

.nav-side-menu ul :not(collapsed) .arrow:before,
.nav-side-menu li :not(collapsed) .arrow:before {
    font-family: FontAwesome;
    content: "\f078";
    display: inline-block;
    padding-left: 10px;
    padding-right: 10px;
    vertical-align: middle;
    float: right;
}

.nav-side-menu ul .active,
.nav-side-menu li .active {
    border-left: 3px solid #d19b3d;
    background-color: #8597ab;
}

.nav-side-menu ul .sub-menu li.active,
.nav-side-menu li .sub-menu li.active {
    color: #d19b3d;
}

.nav-side-menu ul .sub-menu li.active a,
.nav-side-menu li .sub-menu li.active a {
    color: #d19b3d;
}

.nav-side-menu ul .sub-menu li,
.nav-side-menu li .sub-menu li {
    background-color: #181c20;
    border: none;
    line-height: 28px;
    border-bottom: 1px solid #23282e;
    margin-left: 0px;
}

.nav-side-menu ul .sub-menu li:hover,
.nav-side-menu li .sub-menu li:hover {
    background-color: #020203;
}

.nav-side-menu ul .sub-menu li:before,
.nav-side-menu li .sub-menu li:before {
    font-family: FontAwesome;
    content: "\f105";
    display: inline-block;
    padding-left: 10px;
    padding-right: 10px;
    vertical-align: middle;
}

.nav-side-menu li {
    padding-left: 0px;
    border-left: 3px solid #2e353d;
    border-bottom: 1px solid #23282e;
}

.nav-side-menu li a {
    text-decoration: none;
    color: #e1ffff;
}

.nav-side-menu li a i {
    padding-left: 10px;
    width: 20px;
    padding-right: 20px;
}

.nav-side-menu li:hover {
    border-left: 3px solid #d19b3d;
    background-color: #4f5b69;
    -webkit-transition: all 1s ease;
    -moz-transition: all 1s ease;
    -o-transition: all 1s ease;
    -ms-transition: all 1s ease;
    transition: all 1s ease;
}

@media (max-width: 767px) {
    .nav-side-menu {
        position: relative;
        width: 100%;
        margin-bottom: 10px;
    }

    .nav-side-menu .toggle-btn {
        display: block;
        cursor: pointer;
        position: absolute;
        right: 10px;
        top: 10px;
        z-index: 10 !important;
        padding: 3px;
        background-color: #ffffff;
        color: #000;
        width: 40px;
        text-align: center;
    }

    .brand {
        text-align: left !important;
        font-size: 22px;
        padding-left: 20px;
        line-height: 50px !important;
    }
}

@media (min-width: 767px) {
    .nav-side-menu .menu-list .menu-content {
        display: block;
    }

    #main {
        width: calc(100% - 300px);
        float: right;
    }
}

body {
    margin: 0px;
    padding: 0px;
    margin-top: 50px;
    background-color: #222
}


@media (min-width: 768px) {
    body {
        margin-top: 50px;
    }
}

#wrapper {
    padding-left: 0;
}

#page-wrapper {
    width: 100%;
    padding-right: 15px;
    background-color: #d5ceff;
}

.huge {
    font-size: 50px;
    line-height: normal;
}

@media (min-width: 768px) {
    #wrapper {
        padding-left: 225px;
    }

    #page-wrapper {
        padding-top: 30px;
        padding-bottom: 30px;
    }
}

/* Top Navigation */

.top-nav {
    padding: 0 15px;
}

.top-nav > li {
    display: inline-block;
    float: left;
}

.top-nav > li > a {
    padding-top: 15px;
    padding-bottom: 15px;
    line-height: 20px;
    color: #fbfafa;
}

.top-nav > li > a:hover,
.top-nav > li > a:focus,
.top-nav > .open > a,
.top-nav > .open > a:hover,
.top-nav > .open > a:focus {
    color: #fff;
    background-color: #000;

}

.top-nav > .open > .dropdown-menu {
    float: left;
    position: absolute;
    margin-top: 0;
    border: 1px solid rgba(0, 0, 0, .15);
    border-top-left-radius: 0;
    border-top-right-radius: 0;
    background-color: #fff;
    -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, .175);
    box-shadow: 0 6px 12px rgba(0, 0, 0, .175);
}

.top-nav > .open > .dropdown-menu > li > a {
    white-space: normal;
}



h4 {
    color: black !important;
}

.modal-body {
    padding: 40px 50px;
}

.modal-footer {
    background-color: #C5D1E6;
}

h1 {
	margin: 1em 0 0.5em 0;
	color: #343434;
	font-weight: normal;
	font-family: 'Ultra', sans-serif;   
	font-size: 36px;
	line-height: 42px;
	text-transform: uppercase;
	/*text-shadow: 0 2px white, 0 3px #777;*/
}

h2 {
	margin: 1em 0 0.5em 0;
	color: #ff7423;
	font-weight: normal;
	font-size: 30px;
	line-height: 40px;
	font-family: 'Orienta', sans-serif;
	text-transform: uppercase;
    text-align: left;
}

h3 {
	margin: 1em 0 0.5em 0;
	color: #343434;
	font-size: 22px;
	line-height: 40px;
	font-weight: normal;
	/*text-transform: uppercase;*/
	font-family: 'Orienta', sans-serif;
	letter-spacing: 1px;
	font-style: italic;
}

h4 {
	margin: 1em 0 0.5em 0;
	color: #343434;
	font-size: 18px;
	line-height: 20px;
	font-weight: normal;
	font-family: 'Orienta', sans-serif;
}
  </style>
</head>
<body>

<nav class="navbar navbar-fixed-top navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="#">Mans</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li><a href="..">Inici</a></li>
        <li class="active"><a href="results.html">Resultats</a></li>
          <li><a href="dbg.html">Dataset</a></li>
        <li><a href="about.html">Nosaltres</a></li>
        <li><a href="contact.html">Contacte</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">

      </ul>
    </div>
  </div>
</nav>

<div id="page-wrapper">
    <div class="row">
        <div class="col-sm-12">
            <div class="container" id="main">
                <div class="row">
                    <div class="col-sm-8 text-left">
                      <h1>RDF results</h1>
                      <p>
                        En aquesta pàgina mostram els resultats de l'execució del nostre
                        RDF en cada una de les iteracions.
                      </p>
                      <p>
                        Per cada iteració mostram els resultats númerics amb els valors del
                        F1-score, accuracy i Cohen's kappa. Així com una sèrie d'imatges per
                        ilustrar els resultats visualment.
                      </p>
                      <hr>
                    </div>
                    <div id="div-1i" class="col-sm-8 text-left">
                      <h2>Primera iteració</h2>
                      <p>
                        En aquesta primera iteració s'executa l'algorisme amb
                        el <a href="https://cims.nyu.edu/~tompson/NYU_Hand_Pose_Dataset.htm">dataset proporcionat per Tomson et al.</a> .
                      </p>
                      <h3>Configuració programa:</h3>
                      <pre>
---------------------------------------
---------- Configuració RDF: ----------
---------------------------------------
VERSION: 1
DATASET: RDF_Train
m: 300000
OFFSETS_DISTRIBUTION: UNIFORM
N_FEATURES: 100
N_OFFSETS: 2
ROUND_VALUES: -2
OFFSETS_SEED: 10
DATA_IMS_IN_FILE: 2000
DATA_PIXELS_CLASS: 1000
TH_DEPTH: 1800
BG_DEPTH_VALUE: 32767
rf_inc_trees_fit: 15
rf_max_depth: 30
rf_min_samples_leaf: 1
scale_data: False
FOLDER_DATA: /home/bernat/Programas/TFM/data
FOLDER_DATASETS: /home/bernat/datasets/
CLASS_TAG: isHand
                      </pre>
                      <h3>Mètriques</h3>
                      <pre>
           precision    recall  f1-score   support

    Body        0.95      0.98      0.96   1946000
    Hand        0.98      0.95      0.96   1943337

micro avg       0.96      0.96      0.96   3889337
macro avg       0.96      0.96      0.96   3889337
weighted avg    0.96      0.96      0.96   3889337

Cohen kappa score: 0.927497566092
                      </pre>
                      <h3>Imatges</h3>
                      <h4>Resultats genèrics</h4>
                      <p>
                        Els següents tres exemples mostren 3 casos en que l'algorisme té un funcionament correcte.
                      </p>
                      <img src="https://www.dropbox.com/s/9gbz979zeh3svzs/i1-res1.png?dl=1" alt="Smiley face" height="200" width="620">
                      <img src="https://www.dropbox.com/s/kon4gn519bk6dix/i1-res2.png?dl=1" alt="Smiley face" height="200" width="620">
                      <img src="https://www.dropbox.com/s/7ljeku81lkpedvs/i1-res3.png?dl=1" alt="Smiley face" height="200" width="620">

                      <h4>
                        Problematiques detectades
                      </h4>
                      <h5>On acaba la mà i comença el braç?</h5>
                      <img src="https://www.dropbox.com/s/szbbkfrvza25f88/i1-res-problem1.png?dl=1" alt="Smiley face" height="200" width="620">
                      <img src="https://www.dropbox.com/s/58z4cy49ha8clqu/i1-res-problem2.png?dl=1" alt="Smiley face" height="200" width="620">
                      <img src="https://www.dropbox.com/s/4cu7keczg9ljeuy/i1-res-problem3.png?dl=1" alt="Smiley face" height="200" width="620">
                      <img src="https://www.dropbox.com/s/eu72knntjexolcg/i1-res-problem4.png?dl=1" alt="Smiley face" height="200" width="620">

                      <p>Els colzes són extrems del cos, al igual que les mans</p>
                      <img src="https://www.dropbox.com/s/0rotrg9vcfzil5a/i1-res-problem5.png?dl=1" alt="Smiley face" height="200" width="620">
                      <img src="https://www.dropbox.com/s/gzqc8nwr91cu96e/i1-res-problem6.png?dl=1" alt="Smiley face" height="200" width="620">

                      <p>Posicions de les mans, profunditat similar a la resta del cos.</p>
                      <img src="https://www.dropbox.com/s/y0xnaqcbhq2xaaa/i1-res-problem7.png?dl=1" alt="Smiley face" height="200" width="620">
                      <img src="https://www.dropbox.com/s/f9nxiuuoq6kd2at/i1-res-problem8.png?dl=1" alt="Smiley face" height="200" width="620">
                      <img src="https://www.dropbox.com/s/59kceibaxqj46ml/i1-res-problem9.png?dl=1" alt="Smiley face" height="200" width="620">

                    </div>
                    <div id="div-2i" class="col-sm-8 text-left">
                      <h2>Segona iteració</h2>
                      <p>
                        L'objectiu d'aquesta iteració és comprovar si l'algorisme funciona correctament amb imatges agafades
                        del món real.
                      </p>
                      <p>
                        Hem adaptat l'algorisme per a processar imatges agafades directament d'una càmera TOF,
                        concretament la de la kinect 2.
                        També, hem integrat al software una implementació d'un algorisme de Background substraction
                        com el definit a l'article
                          <a href="https://www.sciencedirect.com/science/article/pii/S0167865516302379">
                              Modeling depth for nonparametric foreground segmentation using RGBD devices
                          </a>.
                      </p>
                      <p>
                        Hem reentrenat el RDF amb el dataset que ja havíem utilitzat a la primera iteració,
                        i l'hem validat amb les nostres imatges.
                      </p>
                      <h3>Mètriques</h3>
                      <p>
                        Les mètriques són les mateixes que en la primera iteració ja que
                        utilitzem el mateix classificador.
                      </p>
                      <h3>Imatges</h3>
                      <img src="https://www.dropbox.com/s/4blvihxyxbq2crg/i2-res1.png?dl=1" alt="Smiley face" height="620" width="620">
                      <img src="https://www.dropbox.com/s/r8pq7gngzp7y2po/i2-res2.png?dl=1" alt="Smiley face" height="620" width="620">

                      <h3>Conclusions</h3>
                      <p>
                        La pregunta que ens plantegem en aquest punt i hem de donar resposta per assegurar que aquest no sigui degut
                        a problemes tècnics en la implementació, és perquè el classificador funcionava tan bé amb les imatges del
                        dataset utilitzat per entrenar i no anava bé amb les del món real. Ull! les imatges utilitzades per a testejar el
                        resultat del RDF de la primera tasca no s'havien utilitzat per entrenar.
                      </p>
                      <p>
                        Si es pega una ullada a les imatges del primer dataset es pot observar que totes les imatges estan agafades
                        a una distància semblant, i hi ha molt poca variabilitat en les imatges del dataset.
                        Aquesta és la causa de que els resultats siguin tan bons en imatges preses en un ambient semblant,
                        com ens passa amb el primer conjunt de test.
                      </p>
                    </div>
                    <div id="div-3i" class="col-sm-8 text-left">
                        <h2>Tercera iteració</h2>
                        <p>
                            Per a solventar el problema de la falta de variabilitat de les dades del dataset,
                            en aquesta iteració s'ha elaborat un nou dataset amb el mateix format que l'anterior.
                            S'ha intentat que les imatges del nou dataset continguin la màxima variabilitat possible.
                        </p>
                        <p>
                            En el dataset anterior la majoria de les imatges tenien a una persona asseguda en primer pla.
                            El nostre està format per la següent proporció de distintes imatges:
                        </p>
                        <ul>
                            <li>33 % imatges persona dreta fent moviments amb les mans</li>
                            <li>33 % imatges persona asseguda fent coses.</li>
                            <li>33 % imatges persona caminant.</li>
                        </ul>
                        <p>
                            A més, aquest nou dataset incorpora imatges de persones interactuant
                            amb objectes.
                        </p>
                        <p>
                            Per a testejar el funcionament del mètode amb aquest nou dataset
                        </p>
                        <h3>Configuració programa:</h3>
                        <pre>
---------------------------------------
---------- Configuració RDF: ----------
---------------------------------------
VERSION: 3
DATASETS: ['POSTPROCESSED_RDF_Train', 'BG_dataset/depth']
DATASET: BG_dataset/depth
m: 300000
OFFSETS_USE_ALL: True
OFFSETS_DISTRIBUTION: UNIFORM
N_FEATURES: 1000
N_OFFSETS: 2
ROUND_VALUES: -2
OFFSETS_SEED: 10
DATA_IMS_IN_FILE: 2000
DATA_PIXELS_CLASS: 500
TH_DEPTH: 4000
BG_DEPTH_VALUE: 32767
rf_inc_trees_fit: 15
rf_max_depth: 30
rf_min_samples_leaf: 1
scale_data: False
FOLDER_DATA: /home/bernat/Programas/TFM/data
CLASS_TAG: isHand
                      </pre>
                        <h3>Mètriques</h3>
                        <pre>
              precision    recall  f1-score   support

           0       0.92      0.98      0.95    772000
           1       0.97      0.90      0.93    667358

   micro avg       0.94      0.94      0.94   1439358
   macro avg       0.95      0.94      0.94   1439358
weighted avg       0.94      0.94      0.94   1439358

Cohen kappa score: 0.882431098807
                        </pre>
                        <pre>RDF(max_depth=30, min_samples_leaf=1, n_estimators=30)</pre>
                        <h3>Imatges</h3>
                        <iframe width="560" height="315" src="https://www.youtube.com/embed/W1Kiw7G9j7g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        <h3>
                            Conclusions
                        </h3>
                        <p>
                            Tot i que les mètriques hagin disminuït, al vídeo es pot apreciar com la qualitat dels resultats
                            ha millorat. Ara, l'algorisme ara funciona amb quasi tots els casos.
                        </p>
                        <p>
                            El decrement en el valor de les mètriques es degut a que al augmentar la quantitat de
                            variabilitat de les dades, s'ha incrementat el nombre d'exemples d'entrenament que el mètode
                            no es capaç d'identificar correctament. Així, com també el nou dataset incorpora casos més complexes
                            que no es contemplaven en el dataset anterior com la interacció amb objectes.
                        </p>
                        <p>
                            Gràcies a aquest experiment s'ha verificat que hi ha casos en que és impossible fer que
                            l'algorisme funcioni. Un bon exemple són els colces, el mètode utilitzat és incapaç d'identificar
                            que és un colce i que és una mà.
                        </p>
                        <p>
                            També hem observat que el mètode té una tendència a confondre les cares amb les mans.
                        </p>
                    </div>
                    <div id="div-4i" class="col-sm-8 text-left">
                        <h2>Quarta iteració</h2>
                        <p>
                            L'objectiu que es persegueix en aquesta iteració és mitigar el problema que té l'algorisme,
                            que sovint confon les cares amb les mans.
                        </p>
                        <p>
                            Per aconseguir-ho utilitzem una tècnica que consisteix en afegir una major
                            proporció d'exemples "hard-negatives", els que el classificador té una tèndència a
                            classificar erròniament.
                        </p>
                        <p>
                            Hem aplicat una sèrie de tècniques per a detectar les cares que apareixen en cada imatge.
                            De cada cara identificada hem generat 500 exemples d'entrenament.
                        </p>
                        <p>
                            Finalment, hem fusionat tots els exemples generats amb el conjunt d'entrenament.
                            Una altre contribució que s'ha fet en aquesta iteració és que s'han mesclat els exemples
                            d'entrenament de tots els subconjunts. Així que ara a cada subconjunt d'entrenament
                            hi tenim exemples de totes les imatges. Anteriorment cada subconjunt esteia format per
                            els exemples d'un subconjunt d'imatges concret.
                        </p>
                        <h3>Configuració programa:</h3>
                        <pre>
---------------------------------------
---------- Configuració RDF: ----------
---------------------------------------
VERSION: 4
DATASETS: ['POSTPROCESSED_RDF_Train', 'BG_dataset/depth', 'BG_dataset/depth/datafaces']
DATASET: BG_dataset/depth/datafaces
m: 300000
OFFSETS_USE_ALL: True
OFFSETS_DISTRIBUTION: UNIFORM
N_FEATURES: 1000
N_OFFSETS: 2
ROUND_VALUES: -2
OFFSETS_SEED: 10
DATA_IMS_IN_FILE: 2000
DATA_PIXELS_CLASS: 500
TH_DEPTH: 4000
BG_DEPTH_VALUE: 32767
rf_inc_trees_fit: 15
rf_max_depth: 30
rf_min_samples_leaf: 1
scale_data: False
FOLDER_DATA: /home/bernat/Programas/TFM/data
CLASS_TAG: isHand
                      </pre>
                        <h3>Mètriques</h3>
                        <pre>
              precision    recall  f1-score   support

           0       0.94      0.98      0.96    772000
           1       0.97      0.93      0.95    667358

   micro avg       0.95      0.95      0.95   1439358
   macro avg       0.96      0.95      0.95   1439358
weighted avg       0.95      0.95      0.95   1439358

Cohen kappa score: 0.905983513422
                        </pre>
                        <pre>RDF(max_depth=30, min_samples_leaf=1, n_estimators=30)</pre>
                        <h3>Imatges</h3>
                        <iframe width="560" height="315" src="https://www.youtube.com/embed/42HDgCgPKHE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                </div>
            </div>
        <!-- footers -->
        </div> <!-- /.col -->
    </div> <!-- /.row -->
</div> <!-- /.wrapper -->

<footer class="container-fluid text-center">
  <p>Footer Text</p>
</footer>

</body>
</html>
